:root{
  --bg:#f5f7fb; --card:#fff; --blue:#1f6feb; --text:#111827; --muted:#6b7280;
  --shadow:0 6px 18px rgba(0,0,0,.06);
  --tabbar-h: 56px;
  --vh: 100vh;          
  --safe-bottom: 0px;   
}

*{box-sizing:border-box} html,body{height:100%}
body{margin:0; font:16px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; color:var(--text); background:var(--bg)}
h1{margin:0 0 16px; font-size:26px} h2{margin:0 0 8px}
.muted{color:var(--muted)}

.container{max-width:420px; margin:56px auto 96px; padding:0 16px}
.card{background:var(--card); border-radius:16px; padding:16px; box-shadow:var(--shadow); margin:0 0 14px}

.grid{display:grid; grid-template-columns:1fr 1fr; gap:14px}
.tile{background:var(--card); border:0; border-radius:16px; padding:18px 12px; display:flex; flex-direction:column; align-items:center; gap:8px; box-shadow:var(--shadow); cursor:pointer}
.tile .emoji{font-size:36px} .tile .label{font-weight:600}

.form{display:grid; gap:12px}
.form label{display:grid; gap:6px; font-weight:600}
.form input,.form select{border:1px solid #e5e7eb; border-radius:12px; padding:12px; background:#fff; font-size:16px}
.row2{display:grid; grid-template-columns:1fr 1fr; gap:12px}
.actions{display:flex; flex-wrap:wrap; gap:10px; margin-top:2px}
.primary,.secondary{border:0; border-radius:12px; padding:12px 14px; font-weight:700; cursor:pointer}
.primary{background:var(--blue); color:#fff}
.secondary{background:#eef3ff; color:#173c9a}

.map-wrap{position:relative; margin:12px 0 0; text-align:center; background:var(--card); border-radius:16px; padding:16px; box-shadow:var(--shadow)}
.map{width:100%; max-width:100%; border-radius:12px; display:block}
.overlay{position:absolute; inset:16px; width:calc(100% - 32px); height:calc(100% - 32px); pointer-events:none}
.map-caption{margin:10px 0 0}

.back-button{position:fixed; top:12px; left:12px; z-index:5; background:var(--blue); color:#fff; border:0; padding:8px 12px; border-radius:10px; font-weight:600; box-shadow:var(--shadow); cursor:pointer}
.map-wrap{ contain: layout paint; } /* локализуем перерисовку раздела */

.overlay {
  z-index: 3;
}
.map {
  z-index: 1;
}

.tabbar{
  position:fixed; left:0; right:0; bottom:0; z-index:5;
  height: var(--tabbar-h);
  background:var(--card);
  padding:10px 12px calc(10px + var(--safe-bottom)); /* учитываем safe-area */
  box-shadow:0 -6px 18px rgba(0,0,0,.04);            /* полегче */
  display:flex; gap:10px; justify-content:space-around;
  will-change: transform;
  transform: translateZ(0); /* снимаем «смазывание» при перерисовках */
  backface-visibility: hidden;
}

.tab{background:transparent; border:0; padding:8px 10px; border-radius:10px; font-weight:600; color:var(--muted)}
.tab.active{color:var(--blue); background:rgba(31,111,235,.08)}
.hidden{display:none}
